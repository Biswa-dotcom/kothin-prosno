<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Cognix - Smart Quiz Generator</title>
  <link rel="stylesheet" href="stylesheets/style.css">
  <style>
    /* Reset and Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: Arial, sans-serif;
      background-color: #f8fafc;
      color: #1e293b;
    }

    /* 3D Cube Styles */
    .cube-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 200px;
      height: 200px;
      perspective: 1000px;
      z-index: 1;
    }

    .box-card {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      animation: rotate3d 20s infinite linear;
    }

    .face {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.3rem;
      font-weight: bold;
      backface-visibility: visible;
      border-radius: 12px;
      background: linear-gradient(145deg, rgba(42,42,42,0.8), rgba(56,56,56,0.8));
      border: 2px solid #646cff;
      overflow: hidden;
      text-align: center;
      padding: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    /* Cube Face Positions */
    .front { transform: translateZ(100px); }
    .back { transform: translateZ(-100px) rotateY(180deg); }
    .right { transform: translateX(100px) rotateY(90deg); }
    .left { transform: translateX(-100px) rotateY(-90deg); }
    .top { transform: translateY(-100px) rotateX(90deg); }
    .bottom { transform: translateY(100px) rotateX(-90deg); }

    /* Glow Effects */
    .front { border-color: #646cff; color: #646cff; }
    .back { border-color: #00bcd4; color: #00bcd4; }
    .right { border-color: #4caf50; color: #4caf50; }
    .left { border-color: #ff4081; color: #ff4081; }
    .top { border-color: #ffc107; color: #ffc107; }
    .bottom { border-color: #9c27b0; color: #9c27b0; }

    @keyframes rotate3d {
      0%   { transform: rotateX(0) rotateY(0); }
      25%  { transform: rotateX(90deg) rotateY(90deg); }
      50%  { transform: rotateX(180deg) rotateY(180deg); }
      75%  { transform: rotateX(270deg) rotateY(270deg); }
      100% { transform: rotateX(360deg) rotateY(360deg); }
    }

    /* Hero Section */
    .hero {
      background: linear-gradient(135deg, #eefff2, #e0ffec);
      text-align: center;
      padding: 120px 20px;
      position: relative;
      overflow: hidden;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .hero .container {
      position: relative;
      z-index: 2;
      max-width: 1000px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .hero-title {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .welcome-text {
      font-size: 2.2rem;
      font-weight: 600;
      color: #1e293b;
      letter-spacing: 1px;
      animation: fadeInDown 0.8s ease forwards;
    }

    .cognix-text {
      font-size: 5rem;
      font-weight: 800;
      background: linear-gradient(270deg, #4f46e5, #8b5cf6, #ec4899, #f59e0b);
      background-size: 400% 400%;
      -webkit-background-clip: text;
      color: transparent;
      line-height: 1.1;
      animation: gradientFlow 6s ease infinite, fadeInUp 1s ease 0.5s forwards;
      opacity: 0;
      text-shadow: 0 4px 20px rgba(79, 70, 229, 0.3);
    }

    .hero-subtitle {
      font-size: 1.4rem;
      font-weight: 500;
      color: #475569;
      letter-spacing: 0.5px;
      margin-top: 1.5rem;
      animation: fadeIn 0.8s ease 0.4s forwards;
      opacity: 0;
    }

    /* Animations */
    @keyframes gradientFlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Quiz specific styles */
    .quiz-container {
      display: none;
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
      position: relative;
      z-index: 2;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    
    .question {
      margin: 15px 0;
      padding: 1rem;
      background: #f8fafc;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    .correct { color: #4CAF50; }
    .wrong { color: #F44336; }
    .result { 
      font-weight: bold; 
      margin-top: 20px;
      padding: 1.5rem;
      background: #f8fafc;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    #topicInput {
      padding: 1rem;
      width: 100%;
      max-width: 500px;
      border-radius: 8px;
      border: 2px solid #4682B4;
      font-size: 1rem;
      margin-bottom: 1rem;
      background: white;
    }
    
    .subtopics-container {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin: 1rem 0;
    }
    
    .subtopic-btn {
      margin: 0;
      padding: 0.8rem 1.5rem;
      background: linear-gradient(135deg, #4682B4, #5D9CEC);
      color: white;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    /* Button Styles */
    .btn-primary {
      background: linear-gradient(135deg, #FF6B6B, #FF8E8E);
      color: white;
      padding: 1rem 2rem;
      font-size: 1.2rem;
      font-weight: 600;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      margin: 2rem auto;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 8px rgba(0,0,0,0.15);
      background: linear-gradient(135deg, #FF7B7B, #FF9E9E);
    }
    
    /* Navbar Quiz Button */
    .nav-quiz-btn {
      background: linear-gradient(135deg, #FF6B6B, #FF8E8E);
      color: white;
      padding: 0.8rem 1.5rem;
      font-size: 1rem;
      font-weight: 600;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      margin-left: 1rem;
    }
    
    .nav-quiz-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 8px rgba(0,0,0,0.15);
      background: linear-gradient(135deg, #FF7B7B, #FF9E9E);
    }

    /* Loading State */
    .loading {
      position: relative;
      pointer-events: none;
      opacity: 0.8;
    }
    
    .loading::after {
      content: "";
      position: absolute;
      width: 20px;
      height: 20px;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      margin: auto;
      border: 3px solid transparent;
      border-top-color: white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Progress Indicator */
    .progress-text {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #64748b;
      text-align: center;
    }

    /* About Section */
    .about-section {
      background: linear-gradient(135deg, #f9fafb, #eef2ff);
      padding: 80px 20px;
      text-align: center;
      border-radius: 20px;
      margin: 60px auto;
      max-width: 1100px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }

    .about-header h2 {
      font-size: 2.5rem;
      font-weight: 700;
      color: #1e293b;
      margin-bottom: 10px;
    }

    .about-header h2 span {
      color: #4f46e5;
    }

    .about-header .tagline {
      font-size: 1.2rem;
      color: #64748b;
      margin-bottom: 40px;
      font-style: italic;
    }

    .about-container {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .about-content {
      max-width: 750px;
      text-align: left;
      font-size: 1.1rem;
      line-height: 1.8;
      color: #374151;
    }

    .about-content .highlight {
      color: #4f46e5;
      font-weight: 600;
    }

    .features, .benefits {
      margin: 20px 0;
      padding: 0;
      list-style: none;
    }

    .features li, .benefits li {
      background: #fff;
      margin: 10px 0;
      padding: 14px 18px;
      border-radius: 12px;
      font-size: 1rem;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .features li:hover, .benefits li:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 14px rgba(0,0,0,0.1);
    }

    .benefits span {
      font-weight: 600;
      color: #4f46e5;
    }

    /* FAQ Section */
    .FAQ {
      padding: 60px 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .faq-container h1 {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .faq-item {
      margin-bottom: 1rem;
      border-bottom: 1px solid #e2e8f0;
      padding-bottom: 1rem;
    }
    
    .faq-question {
      cursor: pointer;
      padding: 1rem 0;
    }
    
    .faq-answer {
      padding: 0 1rem;
      display: none;
    }
    
    .faq-item.active .faq-answer {
      display: block;
    }

    /* Contact Section */
    .contactus {
      padding: 60px 20px;
      max-width: 1100px;
      margin: 0 auto;
    }
    
    .contactus .header {
      text-align: center;
      font-size: 2rem;
      margin-bottom: 2rem;
    }
    
    .container2 {
      display: flex;
      gap: 2rem;
      flex-wrap: wrap;
    }
    
    .contact-form, .contact-details {
      flex: 1;
      min-width: 300px;
    }
    
    .contact-form h3, .contact-details h3 {
      margin-bottom: 1.5rem;
    }
    
    .contact-form input, 
    .contact-form textarea {
      width: 100%;
      padding: 1rem;
      margin-bottom: 1rem;
      border: 1px solid #cbd5e1;
      border-radius: 8px;
    }
    
    .contact-form button {
      background: #4f46e5;
      color: white;
      padding: 1rem 2rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .cube-container {
        width: 150px;
        height: 150px;
      }
      .front { transform: translateZ(75px); }
      .back { transform: translateZ(-75px) rotateY(180deg); }
      .right { transform: translateX(75px) rotateY(90deg); }
      .left { transform: translateX(-75px) rotateY(-90deg); }
      .top { transform: translateY(-75px) rotateX(90deg); }
      .bottom { transform: translateY(75px) rotateX(-90deg); }
      
      .cognix-text {
        font-size: 3.5rem;
      }
      
      .btn-primary {
        padding: 0.8rem 1.5rem;
        font-size: 1rem;
      }
      
      .nav-quiz-btn {
        padding: 0.6rem 1rem;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="nav">
    <div class="logo">
      <img src="media/project2.png" class="logo-img" alt="Cognix Logo">
    </div>
    <div class="button">
      <a href="#section1" class="buttons">Home</a>
      <a href="#section2" class="buttons">About</a>
      <a href="#section3" class="buttons">Contact Us</a>
      <button class="nav-quiz-btn" id="navQuizBtn">
        <span>üéØ Start Quiz</span>
      </button>
      <button class="theme-button">Change Theme</button>
    </div>
  </nav>

  <!-- Hero Section with Cube -->
  <section class="hero" id="section1">
    <!-- 3D Cube Background Element -->
    <div class="cube-container">
      <div class="box-card">
        <div class="face front">WELCOME</div>
        <div class="face back">COGNIX</div>
        <div class="face right">MCQ GENERATION</div>
        <div class="face left">AI POWERED</div>
        <div class="face top"></div>
        <div class="face bottom"></div>
      </div>
    </div>

    <!-- Hero Content -->
    <div class="container">
      <div class="home">
        <h1 class="hero-title">
          <span class="welcome-text">Welcome to</span>
          <span class="cognix-text">COGNIX</span>
        </h1>
        <h3 class="hero-subtitle">AI-Powered Smart Quiz Generator</h3>
      </div>
      <button class="btn-primary" id="heroQuizBtn">
        <span>Start Quiz Now</span>
      </button>
    </div>
  </section>

  <!-- Quiz Section -->
  <section class="quiz-container" id="quiz-section">
    <div id="topic-selection">
      <h2>AI Quiz Generator</h2>
      <p>Enter any topic to generate personalized quiz questions:</p>
      
      <div style="display: flex; gap: 0.6rem; align-items: center;">
        <input type="text" id="topicInput" placeholder="e.g. Physics, World History, Python Programming...">
        <button class="btn-primary" id="generateSubtopicsBtn" style="background: linear-gradient(135deg, #4682B4, #5D9CEC);">
          <span>üîç Generate Subtopics</span>
        </button>
      </div>
      
      <div id="progressText" class="progress-text" style="display: none;"></div>

      <div id="subtopicsSection" style="display: none;">
        <h3>Choose a subtopic:</h3>
        <div class="subtopics-container" id="subtopics"></div>
      </div>
    </div>

    <div id="quizSection" style="display: none;">
      <h3>üìù MCQ Quiz</h3>
      <form id="quizForm"></form>
      <button class="btn-primary" id="submitQuizBtn" style="background: linear-gradient(135deg, #4682B4, #5D9CEC);">
        <span>üì§ Submit Answers</span>
      </button>
    </div>

    <div id="resultSection" style="display: none;">
      <div class="result" id="score"></div>
      <div id="weakTopics"></div>
      <button class="btn-primary" id="restartQuizBtn">
        <span>üîÑ Start New Quiz</span>
      </button>
    </div>
  </section>

  <!-- About Section -->
  <section class="about-section" id="section2">
    <div class="about-header">
      <h2>About <span>COGNIX</span></h2>
      <p class="tagline">Smarter Learning. Faster Results.</p>
    </div>

    <div class="about-container">
      <div class="about-content">
        <p>
          At <strong>COGNIX</strong>, we believe learning should be 
          <span class="highlight">interactive</span>, 
          <span class="highlight">personalized</span>, 
          and <span class="highlight">AI-driven</span>.
        </p>
        <p>
          Our mission is to empower students, professionals, and lifelong learners to 
          master any topic with <strong>smart, adaptive quizzes</strong>.
        </p>

        <ul class="features">
          <li>‚ö° <strong>Accurate & dynamic</strong> question generation</li>
          <li>üìä <strong>Instant feedback</strong> to track progress</li>
          <li>üéØ <strong>Insights</strong> into strengths & weaknesses</li>
        </ul>

        <p>
          We make exam preparation:
        </p>
        <ul class="benefits">
          <li><span>üöÄ Faster</span>  No more hunting for quality practice questions</li>
          <li><span>üß† Smarter</span>  AI adapts to your learning style</li>
          <li><span>üéÆ Engaging</span> Interactive UI keeps you motivated</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="FAQ">
    <div class="faq-container">
      <h1>Frequently Asked Questions</h1>
      <div class="faq-item">
        <h2 class="faq-question">1. What is COGNIX?</h2>
        <div class="faq-answer">
          <p>COGNIX is an AI-powered exam preparation platform that generates 10 MCQs for any chosen topic, evaluates your answers, and helps you improve weak areas.</p>
        </div>
      </div>
      <div class="faq-item">
        <h2 class="faq-question">2. How does it generate questions?</h2>
        <div class="faq-answer">
          <p>We use Ollama with LLaMA 2 models and custom prompt engineering to create high-quality, relevant MCQs in real-time.</p>
        </div>
      </div>
      <div class="faq-item">
        <h2 class="faq-question">3. How to use?</h2>
        <div class="faq-answer">
          <p>Simply click "Start Quiz", enter a topic, select a subtopic, and begin answering the generated questions.</p>
        </div>
      </div>
      <div class="faq-item">
        <h2 class="faq-question">4. Is it free to use?</h2>
        <div class="faq-answer">
          <p>Yes! At this stage, COGNIX is free to use. Premium features may be introduced later.</p>
        </div>
      </div>
      <div class="faq-item">
        <h2 class="faq-question">5. Can I practice offline?</h2>
        <div class="faq-answer">
          <p>Right now, COGNIX works online only, as it requires AI model access. Offline practice mode is in our future roadmap.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section class="contactus" id="section3">
    <div class="header">Contact Us</div>
    <div class="container2">
      <div class="contact-form">
        <h3>Send Us A Message</h3>
        <form action="https://api.web3forms.com/submit" method="POST">
          <input type="hidden" name="access_key" value="938a877b-d86f-47d4-bf5e-f264cfc71745">
          <input type="text" placeholder="First Name" name="First Name" required>
          <input type="text" placeholder="Last Name" name="Last Name" required>
          <input type="email" placeholder="Email" name="email" required>
          <textarea placeholder="Type your message here..." rows="4" name="message" required></textarea>
          <button type="submit" class="btn">Submit</button>
        </form>
      </div>
      <div class="contact-details">
        <h3>Contact Details</h3>
        <p>Email: tiyasavsnpatra2006@gmail.com</p>
        <p>Address: Jalpaiguri Govt. Engineering College, Jalpaiguri, West Bengal</p>
      </div>
    </div>
  </section>

  <script>
    // Theme toggle
    document.querySelector(".theme-button").addEventListener("click", function() {
      document.body.classList.toggle("dark");
    });

    // FAQ toggle
    document.querySelectorAll(".faq-question").forEach(q => {
      q.addEventListener("click", () => {
        q.parentElement.classList.toggle("active");
      });
    });

    // Quiz functionality
    const apiBase = "http://127.0.0.1:8000"; // adjust if needed
    let currentSubtopic = "";
    let answerRecords = [];
    let generationTime = 0;

    // Show quiz section when Start Quiz is clicked
    function showQuizSection() {
      document.querySelector('.quiz-container').style.display = 'block';
      window.location.href = '#quiz-section';
      document.getElementById('topic-selection').style.display = 'block';
      document.getElementById('quizSection').style.display = 'none';
      document.getElementById('resultSection').style.display = 'none';
      document.getElementById('topicInput').focus();
    }

    document.getElementById('navQuizBtn').addEventListener('click', showQuizSection);
    document.getElementById('heroQuizBtn').addEventListener('click', showQuizSection);

    async function generateSubtopics() {
      const topic = document.getElementById("topicInput").value.trim();
      if (!topic) {
        alert("Please enter a topic");
        return;
      }

      const btn = document.getElementById("generateSubtopicsBtn");
      const originalText = btn.innerHTML;
      btn.classList.add("loading");
      btn.innerHTML = '<span></span>'; // Empty span for loading animation
      
      const progressText = document.getElementById("progressText");
      progressText.style.display = "block";
      progressText.textContent = "Generating subtopics... (usually takes 5-10 seconds)";
      
      const startTime = Date.now();

      try {
        const res = await fetch(`${apiBase}/generate_subtopics`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ topic })
        });
        
        generationTime = (Date.now() - startTime) / 1000;
        const data = await res.json();

        const subtopicsDiv = document.getElementById("subtopics");
        subtopicsDiv.innerHTML = "";
        
        // Animate each subtopic button with delay
        data.forEach((item, index) => {
          setTimeout(() => {
            const btn = document.createElement("button");
            btn.className = "subtopic-btn";
            btn.innerHTML = `<span>${item.title}</span>`;
            btn.onclick = () => loadMCQs(item.title);
            subtopicsDiv.appendChild(btn);
          }, index * 100);
        });

        document.getElementById("subtopicsSection").style.display = "block";
        progressText.textContent = `Generated ${data.length} subtopics in ${generationTime.toFixed(1)} seconds`;
        
      } catch (error) {
        console.error("Error generating subtopics:", error);
        progressText.textContent = "Failed to generate subtopics. Please try again.";
      } finally {
        btn.classList.remove("loading");
        btn.innerHTML = originalText;
      }
    }

    async function loadMCQs(subtopic) {
      currentSubtopic = subtopic;
      const btn = document.getElementById("generateSubtopicsBtn");
      const originalText = btn.innerHTML;
      btn.classList.add("loading");
      btn.innerHTML = '<span></span>';
      
      const progressText = document.getElementById("progressText");
      progressText.textContent = `Generating questions about ${subtopic}...`;

      try {
        const res = await fetch(`${apiBase}/generate_mcqs`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ subtopic })
        });
        const questions = await res.json();

        const quizForm = document.getElementById("quizForm");
        quizForm.innerHTML = "";
        
        questions.forEach((q, index) => {
          const div = document.createElement("div");
          div.className = "question";

          div.innerHTML += `<p><strong>${index + 1}. ${q.question}</strong></p>`;
          q.options.forEach((opt, i) => {
            div.innerHTML += `
              <label class="quiz-option">
                <input type="radio" name="q${index}" value="${opt}">
                ${opt}
              </label>`;
          });

          div.dataset.correct = q.answer;
          quizForm.appendChild(div);
        });

        document.getElementById("topic-selection").style.display = "none";
        document.getElementById("quizSection").style.display = "block";
        progressText.textContent = `Generated ${questions.length} questions in ${generationTime.toFixed(1)} seconds`;
        
      } catch (error) {
        console.error("Error loading MCQs:", error);
        progressText.textContent = "Failed to load questions. Please try again.";
      } finally {
        btn.classList.remove("loading");
        btn.innerHTML = originalText;
      }
    }

    function submitQuiz() {
      const questions = document.querySelectorAll(".question");
      let score = 0;
      answerRecords = [];

      questions.forEach((q, index) => {
        const selected = q.querySelector(`input[name="q${index}"]:checked`);
        const correct = q.dataset.correct;

        if (selected) {
          const isCorrect = selected.value === correct;
          if (isCorrect) {
            score++;
            selected.parentElement.classList.add("correct");
          } else {
            selected.parentElement.classList.add("wrong");
          }

          answerRecords.push({ subtopic: currentSubtopic, is_correct: isCorrect });
        }
      });

      document.getElementById("score").innerHTML = `
        <h3>üìä Quiz Results</h3>
        <p>Your score: <strong>${score} / ${questions.length}</strong> (${Math.round(score/questions.length*100)}%)</p>
      `;
      
      analyzeWeakness();
      document.getElementById("quizSection").style.display = "none";
      document.getElementById("resultSection").style.display = "block";
      window.location.href = '#quiz-section';
    }

    async function analyzeWeakness() {
      try {
        const res = await fetch(`${apiBase}/analyze_weakness`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(answerRecords)
        });
        const data = await res.json();

        const weak = data.weak_topics || [];
        const msg = weak.length
          ? `<div style="margin-top: 1rem;">
              <h4>üìå Areas to Improve</h4>
              <ul style="margin-top: 0.5rem;">${weak.map(t => `<li>${t}</li>`).join('')}</ul>
             </div>`
          : `<p style="margin-top: 1rem;">üéâ Excellent! You've mastered all the concepts!</p>`;

        document.getElementById("weakTopics").innerHTML = msg;
      } catch (error) {
        console.error("Error analyzing weakness:", error);
        document.getElementById("weakTopics").innerHTML = 
          "<p>Could not analyze weak topics at this time.</p>";
      }
    }

    function restartQuiz() {
      document.getElementById("topicInput").value = "";
      document.getElementById("topic-selection").style.display = "block";
      document.getElementById("subtopicsSection").style.display = "none";
      document.getElementById("quizSection").style.display = "none";
      document.getElementById("resultSection").style.display = "none";
      document.getElementById("progressText").textContent = "";
      window.location.href = '#quiz-section';
    }

    // Event listeners for buttons
    document.getElementById("generateSubtopicsBtn").addEventListener("click", generateSubtopics);
    document.getElementById("submitQuizBtn").addEventListener("click", submitQuiz);
    document.getElementById("restartQuizBtn").addEventListener("click", restartQuiz);

    // Allow pressing Enter in topic input
    document.getElementById("topicInput").addEventListener("keypress", function(e) {
      if (e.key === "Enter") {
        generateSubtopics();
      }
    });
  </script>
</body>
</html>